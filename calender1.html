<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ïä§ÎßàÌä∏ Ï∫òÎ¶∞Îçî - ÏùºÏ†ï Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú</title>
    <style>
        /* CSS Reset Î∞è Í∏∞Î≥∏ Ïä§ÌÉÄÏùº */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* ÎùºÏù¥Ìä∏ ÌÖåÎßà ÏÉâÏÉÅ */
            --primary-color: #1976d2;
            --secondary-color: #42a5f5;
            --background-color: #ffffff;
            --surface-color: #f5f5f5;
            --text-color: #212121;
            --text-secondary: #757575;
            --border-color: #e0e0e0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --hover-color: rgba(25, 118, 210, 0.1);
        }

        [data-theme="dark"] {
            /* Îã§ÌÅ¨ ÌÖåÎßà ÏÉâÏÉÅ */
            --primary-color: #90caf9;
            --secondary-color: #64b5f6;
            --background-color: #121212;
            --surface-color: #1e1e1e;
            --text-color: #ffffff;
            --text-secondary: #b0b0b0;
            --border-color: #333333;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --success-color: #81c784;
            --warning-color: #ffb74d;
            --error-color: #e57373;
            --hover-color: rgba(144, 202, 249, 0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
            overflow-x: hidden;
        }

        /* Ìó§Îçî Ïä§ÌÉÄÏùº */
        .header {
            background-color: var(--surface-color);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            box-shadow: 0 2px 4px var(--shadow-color);
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 1.8rem;
            font-weight: 600;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px var(--shadow-color);
        }

        .btn-secondary {
            background-color: var(--surface-color);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .btn-icon {
            padding: 0.5rem;
            min-width: 40px;
            justify-content: center;
        }

        .view-selector {
            display: flex;
            background-color: var(--surface-color);
            border-radius: 6px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .view-btn {
            padding: 0.5rem 1rem;
            border: none;
            background-color: transparent;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s ease;
            border-right: 1px solid var(--border-color);
        }

        .view-btn:last-child {
            border-right: none;
        }

        .view-btn.active {
            background-color: var(--primary-color);
            color: white;
        }

        .search-container {
            position: relative;
        }

        .search-input {
            padding: 0.5rem 2.5rem 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--background-color);
            color: var(--text-color);
            width: 200px;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);
        }

        .search-icon {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà */
        .main-container {
            display: flex;
            height: calc(100vh - 80px);
        }

        /* ÏÇ¨Ïù¥ÎìúÎ∞î */
        .sidebar {
            width: 280px;
            background-color: var(--surface-color);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .sidebar-section {
            margin-bottom: 2rem;
        }

        .sidebar-section h3 {
            margin-bottom: 1rem;
            color: var(--text-color);
            font-size: 1rem;
            font-weight: 600;
        }

        .category-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .category-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .category-item:hover {
            background-color: var(--hover-color);
        }

        .category-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        .category-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
        }

        .mini-calendar {
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
        }

        .mini-calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .mini-calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            text-align: center;
        }

        .mini-calendar-day {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .mini-calendar-day:hover {
            background-color: var(--hover-color);
        }

        .mini-calendar-day.today {
            background-color: var(--primary-color);
            color: white;
        }

        .mini-calendar-day.other-month {
            color: var(--text-secondary);
        }

        /* Ï∫òÎ¶∞Îçî Î©îÏù∏ Î∑∞ */
        .calendar-container {
            flex: 1;
            padding: 1.5rem;
            overflow: auto;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .current-date {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color);
        }

        /* ÏõîÍ∞Ñ Î∑∞ */
        .month-view {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px var(--shadow-color);
        }

        .day-header {
            background-color: var(--surface-color);
            padding: 1rem;
            text-align: center;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .day-cell {
            background-color: var(--background-color);
            min-height: 120px;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .day-cell:hover {
            background-color: var(--hover-color);
        }

        .day-cell.other-month {
            background-color: var(--surface-color);
            color: var(--text-secondary);
        }

        .day-cell.today {
            background-color: rgba(25, 118, 210, 0.1);
        }

        .day-number {
            font-weight: 600;
            margin-bottom: 0.5rem;
            align-self: flex-start;
        }

        .day-cell.today .day-number {
            background-color: var(--primary-color);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }

        .event-list {
            display: flex;
            flex-direction: column;
            gap: 2px;
            flex: 1;
        }

        .event-item {
            background-color: var(--primary-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .event-item:hover {
            transform: scale(1.02);
            box-shadow: 0 2px 4px var(--shadow-color);
        }

        /* Ï£ºÍ∞Ñ Î∑∞ */
        .week-view {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr);
            gap: 1px;
            background-color: var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px var(--shadow-color);
        }

        .time-slot {
            background-color: var(--surface-color);
            padding: 0.5rem;
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .hour-cell {
            background-color: var(--background-color);
            height: 60px;
            position: relative;
            border-bottom: 1px solid var(--border-color);
        }

        /* ÏùºÍ∞Ñ Î∑∞ */
        .day-view {
            display: grid;
            grid-template-columns: 60px 1fr;
            gap: 1px;
            background-color: var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px var(--shadow-color);
        }

        .day-view-container {
            position: relative;
            background-color: var(--background-color);
        }

        .day-event-item {
            position: absolute;
            background-color: var(--primary-color);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 1px 3px var(--shadow-color);
            z-index: 10;
        }

        .day-event-item:hover {
            z-index: 20;
            box-shadow: 0 2px 8px var(--shadow-color);
            transform: scale(1.02);
        }

        .day-event-item.overlapping {
            opacity: 0.9;
        }

        /* Î™®Îã¨ Ïä§ÌÉÄÏùº */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: var(--background-color);
            border-radius: 12px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px var(--shadow-color);
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-header h2 {
            color: var(--text-color);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .close-btn:hover {
            background-color: var(--hover-color);
            color: var(--text-color);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-color);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--background-color);
            color: var(--text-color);
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--background-color);
            color: var(--text-color);
            font-size: 1rem;
            cursor: pointer;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--primary-color);
        }

        .color-picker {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.2s ease;
        }

        .color-option.selected {
            border-color: var(--text-color);
            transform: scale(1.1);
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        /* ÏïåÎ¶º Ïä§ÌÉÄÏùº */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 4px 12px var(--shadow-color);
            z-index: 1001;
            animation: slideInRight 0.3s ease;
            max-width: 300px;
        }

        .notification.success {
            border-left: 4px solid var(--success-color);
        }

        .notification.warning {
            border-left: 4px solid var(--warning-color);
        }

        .notification.error {
            border-left: 4px solid var(--error-color);
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .notification-title {
            font-weight: 600;
            color: var(--text-color);
        }

        .notification-content {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        /* Î°úÎî© Ïä§ÌîºÎÑà */
        .loading-spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        /* Ïï†ÎãàÎ©îÏù¥ÏÖò */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
                flex-direction: column;
                align-items: stretch;
            }

            .header-controls {
                justify-content: space-between;
            }

            .search-input {
                width: 150px;
            }

            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                height: 100vh;
                z-index: 999;
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-container {
                margin-left: 0;
            }

            .day-cell {
                min-height: 80px;
                padding: 0.25rem;
            }

            .event-item {
                font-size: 0.625rem;
                padding: 1px 4px;
            }

            .modal-content {
                padding: 1rem;
                margin: 1rem;
            }
        }

        @media (max-width: 480px) {
            .month-view {
                grid-template-columns: repeat(7, 1fr);
                gap: 0;
            }

            .day-cell {
                min-height: 60px;
                padding: 0.125rem;
            }

            .day-number {
                font-size: 0.75rem;
            }

            .event-item {
                font-size: 0.5rem;
                padding: 1px 2px;
            }
        }

        /* Ïà®ÍπÄ ÌÅ¥ÎûòÏä§ */
        .hidden {
            display: none !important;
        }

        /* ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ */
        .dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .drop-zone {
            background-color: rgba(25, 118, 210, 0.1);
            border: 2px dashed var(--primary-color);
        }

        /* ÌÖåÎßà ÌÜ†Í∏Ä Î≤ÑÌäº */
        .theme-toggle {
            position: relative;
            width: 50px;
            height: 25px;
            background-color: var(--border-color);
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 21px;
            height: 21px;
            background-color: var(--background-color);
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        [data-theme="dark"] .theme-toggle {
            background-color: var(--primary-color);
        }

        [data-theme="dark"] .theme-toggle::before {
            transform: translateX(25px);
        }
    </style>
</head>
<body>
    <!-- Ìó§Îçî -->
    <header class="header">
        <div class="header-left">
            <h1>üìÖ Ïä§ÎßàÌä∏ Ï∫òÎ¶∞Îçî</h1>
        </div>
        <div class="header-controls">
            <div class="nav-controls">
                <button class="btn btn-icon" id="prevBtn" title="Ïù¥Ï†Ñ">‚ùÆ</button>
                <button class="btn btn-secondary" id="todayBtn">Ïò§Îäò</button>
                <button class="btn btn-icon" id="nextBtn" title="Îã§Ïùå">‚ùØ</button>
            </div>
            <div class="view-selector">
                <button class="view-btn active" data-view="month">Ïõî</button>
                <button class="view-btn" data-view="week">Ï£º</button>
                <button class="view-btn" data-view="day">Ïùº</button>
            </div>
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="ÏùºÏ†ï Í≤ÄÏÉâ...">
                <span class="search-icon">üîç</span>
            </div>
            <button class="btn" id="addEventBtn">+ ÏùºÏ†ï Ï∂îÍ∞Ä</button>
            <div class="theme-toggle" id="themeToggle" title="Îã§ÌÅ¨Î™®Îìú Ï†ÑÌôò"></div>
        </div>
    </header>

    <!-- Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
    <div class="main-container">
        <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <aside class="sidebar" id="sidebar">
            <!-- ÎØ∏Îãà Ï∫òÎ¶∞Îçî -->
            <div class="sidebar-section">
                <div class="mini-calendar">
                    <div class="mini-calendar-header">
                        <button class="btn btn-icon" id="miniPrevBtn">‚ùÆ</button>
                        <span id="miniCalendarTitle">2024ÎÖÑ 1Ïõî</span>
                        <button class="btn btn-icon" id="miniNextBtn">‚ùØ</button>
                    </div>
                    <div class="mini-calendar-grid" id="miniCalendarGrid">
                        <!-- ÎØ∏Îãà Ï∫òÎ¶∞Îçî ÎÇ†ÏßúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                </div>
            </div>

            <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ù -->
            <div class="sidebar-section">
                <h3>Ïπ¥ÌÖåÍ≥†Î¶¨</h3>
                <div class="category-list" id="categoryList">
                    <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
                <button class="btn btn-secondary" id="addCategoryBtn" style="width: 100%; margin-top: 1rem;">+ Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä</button>
            </div>

            <!-- ÌïÑÌÑ∞ ÏòµÏÖò -->
            <div class="sidebar-section">
                <h3>ÌïÑÌÑ∞</h3>
                <div class="checkbox-group">
                    <input type="checkbox" id="allDayFilter" class="checkbox">
                    <label for="allDayFilter">Ï¢ÖÏùº ÏùºÏ†ïÎßå</label>
                </div>
                <div class="checkbox-group" style="margin-top: 0.5rem;">
                    <input type="checkbox" id="reminderFilter" class="checkbox">
                    <label for="reminderFilter">ÏïåÎ¶º ÏÑ§Ï†ïÎêú ÏùºÏ†ïÎßå</label>
                </div>
            </div>
        </aside>

        <!-- Ï∫òÎ¶∞Îçî Î©îÏù∏ Î∑∞ -->
        <main class="calendar-container">
            <div class="calendar-header">
                <h2 class="current-date" id="currentDate">2024ÎÖÑ 1Ïõî</h2>
                <div class="calendar-controls">
                    <button class="btn btn-secondary" id="exportBtn">ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
                    <button class="btn btn-secondary" id="importBtn">Í∞ÄÏ†∏Ïò§Í∏∞</button>
                    <input type="file" id="importFile" style="display: none;" accept=".json">
                </div>
            </div>

            <!-- ÏõîÍ∞Ñ Î∑∞ -->
            <div class="month-view" id="monthView">
                <!-- ÏõîÍ∞Ñ Ï∫òÎ¶∞ÎçîÍ∞Ä Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>

            <!-- Ï£ºÍ∞Ñ Î∑∞ -->
            <div class="week-view hidden" id="weekView">
                <!-- Ï£ºÍ∞Ñ Ï∫òÎ¶∞ÎçîÍ∞Ä Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>

            <!-- ÏùºÍ∞Ñ Î∑∞ -->
            <div class="day-view hidden" id="dayView">
                <!-- ÏùºÍ∞Ñ Ï∫òÎ¶∞ÎçîÍ∞Ä Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
        </main>
    </div>

    <!-- ÏùºÏ†ï Ï∂îÍ∞Ä/Ìé∏Ïßë Î™®Îã¨ -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ÏùºÏ†ï Ï∂îÍ∞Ä</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <form id="eventForm">
                <div class="form-group">
                    <label for="eventTitle">Ï†úÎ™© *</label>
                    <input type="text" id="eventTitle" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="eventDescription">ÏÑ§Î™Ö</label>
                    <textarea id="eventDescription" class="form-input" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="eventStartDate">ÏãúÏûë ÎÇ†Ïßú/ÏãúÍ∞Ñ *</label>
                    <input type="datetime-local" id="eventStartDate" class="form-input" required>
                </div>
                <div class="form-group">
                    <label for="eventEndDate">Ï¢ÖÎ£å ÎÇ†Ïßú/ÏãúÍ∞Ñ *</label>
                    <input type="datetime-local" id="eventEndDate" class="form-input" required>
                </div>
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="allDayEvent" class="checkbox">
                        <label for="allDayEvent">Ï¢ÖÏùº ÏùºÏ†ï</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="eventCategory">Ïπ¥ÌÖåÍ≥†Î¶¨</label>
                    <select id="eventCategory" class="form-select">
                        <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ ÏòµÏÖòÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </select>
                </div>
                <div class="form-group">
                    <label>ÏÉâÏÉÅ</label>
                    <div class="color-picker" id="colorPicker">
                        <!-- ÏÉâÏÉÅ ÏòµÏÖòÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                </div>
                <div class="form-group">
                    <label for="reminderTime">ÏïåÎ¶º</label>
                    <select id="reminderTime" class="form-select">
                        <option value="0">ÏïåÎ¶º ÏóÜÏùå</option>
                        <option value="5">5Î∂Ñ Ï†Ñ</option>
                        <option value="15">15Î∂Ñ Ï†Ñ</option>
                        <option value="30">30Î∂Ñ Ï†Ñ</option>
                        <option value="60">1ÏãúÍ∞Ñ Ï†Ñ</option>
                        <option value="1440">1Ïùº Ï†Ñ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="repeatType">Î∞òÎ≥µ</label>
                    <select id="repeatType" class="form-select">
                        <option value="none">Î∞òÎ≥µ ÏóÜÏùå</option>
                        <option value="daily">Îß§Ïùº</option>
                        <option value="weekly">Îß§Ï£º</option>
                        <option value="monthly">Îß§Ïõî</option>
                        <option value="yearly">Îß§ÎÖÑ</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="deleteEventBtn" style="display: none;">ÏÇ≠Ï†ú</button>
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Ï∑®ÏÜå</button>
                    <button type="submit" class="btn">Ï†ÄÏû•</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ïπ¥ÌÖåÍ≥†Î¶¨ Ï∂îÍ∞Ä</h2>
                <button class="close-btn" id="closeCategoryModal">&times;</button>
            </div>
            <form id="categoryForm">
                <div class="form-group">
                    <label for="categoryName">Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶Ñ *</label>
                    <input type="text" id="categoryName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label>ÏÉâÏÉÅ</label>
                    <div class="color-picker" id="categoryColorPicker">
                        <!-- ÏÉâÏÉÅ ÏòµÏÖòÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="cancelCategoryBtn">Ï∑®ÏÜå</button>
                    <button type="submit" class="btn">Ï∂îÍ∞Ä</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let currentDate = new Date();
        let currentView = 'month';
        let events = JSON.parse(localStorage.getItem('calendarEvents')) || [];
        let categories = JSON.parse(localStorage.getItem('calendarCategories')) || [
            { id: 'work', name: 'ÏóÖÎ¨¥', color: '#1976d2', active: true },
            { id: 'personal', name: 'Í∞úÏù∏', color: '#4caf50', active: true },
            { id: 'family', name: 'Í∞ÄÏ°±', color: '#ff9800', active: true },
            { id: 'health', name: 'Í±¥Í∞ï', color: '#e91e63', active: true }
        ];
        let editingEventId = null;
        let reminderTimeouts = [];

        // ÏÉâÏÉÅ ÌåîÎ†àÌä∏
        const colorPalette = [
            '#1976d2', '#4caf50', '#ff9800', '#e91e63',
            '#9c27b0', '#673ab7', '#3f51b5', '#2196f3',
            '#00bcd4', '#009688', '#8bc34a', '#cddc39',
            '#ffeb3b', '#ffc107', '#ff5722', '#795548'
        ];

        // DOM ÏöîÏÜå Ï∞∏Ï°∞
        const elements = {
            prevBtn: document.getElementById('prevBtn'),
            nextBtn: document.getElementById('nextBtn'),
            todayBtn: document.getElementById('todayBtn'),
            currentDateEl: document.getElementById('currentDate'),
            monthView: document.getElementById('monthView'),
            weekView: document.getElementById('weekView'),
            dayView: document.getElementById('dayView'),
            viewBtns: document.querySelectorAll('.view-btn'),
            eventModal: document.getElementById('eventModal'),
            eventForm: document.getElementById('eventForm'),
            addEventBtn: document.getElementById('addEventBtn'),
            closeModal: document.getElementById('closeModal'),
            deleteEventBtn: document.getElementById('deleteEventBtn'),
            cancelBtn: document.getElementById('cancelBtn'),
            categoryModal: document.getElementById('categoryModal'),
            categoryForm: document.getElementById('categoryForm'),
            addCategoryBtn: document.getElementById('addCategoryBtn'),
            closeCategoryModal: document.getElementById('closeCategoryModal'),
            cancelCategoryBtn: document.getElementById('cancelCategoryBtn'),
            searchInput: document.getElementById('searchInput'),
            themeToggle: document.getElementById('themeToggle'),
            exportBtn: document.getElementById('exportBtn'),
            importBtn: document.getElementById('importBtn'),
            importFile: document.getElementById('importFile'),
            categoryList: document.getElementById('categoryList'),
            miniCalendarGrid: document.getElementById('miniCalendarGrid'),
            miniCalendarTitle: document.getElementById('miniCalendarTitle'),
            miniPrevBtn: document.getElementById('miniPrevBtn'),
            miniNextBtn: document.getElementById('miniNextBtn')
        };

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
            registerEventListeners();
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨ Î†åÎçîÎßÅ
            renderCategories();
            
            // ÏÉâÏÉÅ ÌîºÏª§ Ï¥àÍ∏∞Ìôî
            initializeColorPickers();
            
            // Ï¥àÍ∏∞ Ï∫òÎ¶∞Îçî Î†åÎçîÎßÅ
            renderCalendar();
            
            // ÎØ∏Îãà Ï∫òÎ¶∞Îçî Î†åÎçîÎßÅ
            renderMiniCalendar();
            
            // ÏïåÎ¶º Í∂åÌïú ÏöîÏ≤≠
            requestNotificationPermission();
            
            // ÏïåÎ¶º Ïä§ÏºÄÏ§Ñ ÏÑ§Ï†ï
            scheduleReminders();
            
            // ÌÖåÎßà Ï¥àÍ∏∞Ìôî
            initializeTheme();
            
            console.log('Ïä§ÎßàÌä∏ Ï∫òÎ¶∞ÎçîÍ∞Ä Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.');
        }

        function registerEventListeners() {
            // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î≤ÑÌäº
            elements.prevBtn.addEventListener('click', () => navigateCalendar(-1));
            elements.nextBtn.addEventListener('click', () => navigateCalendar(1));
            elements.todayBtn.addEventListener('click', goToToday);

            // Î∑∞ Ï†ÑÌôò Î≤ÑÌäº
            elements.viewBtns.forEach(btn => {
                btn.addEventListener('click', () => switchView(btn.dataset.view));
            });

            // ÏùºÏ†ï Ï∂îÍ∞Ä Î≤ÑÌäº
            elements.addEventBtn.addEventListener('click', () => openEventModal());

            // Î™®Îã¨ Í¥ÄÎ†®
            elements.closeModal.addEventListener('click', closeEventModal);
            elements.cancelBtn.addEventListener('click', closeEventModal);
            elements.deleteEventBtn.addEventListener('click', deleteEvent);
            elements.eventForm.addEventListener('submit', saveEvent);

            // Ïπ¥ÌÖåÍ≥†Î¶¨ Î™®Îã¨
            elements.addCategoryBtn.addEventListener('click', () => openCategoryModal());
            elements.closeCategoryModal.addEventListener('click', closeCategoryModal);
            elements.cancelCategoryBtn.addEventListener('click', closeCategoryModal);
            elements.categoryForm.addEventListener('submit', saveCategory);

            // Í≤ÄÏÉâ
            elements.searchInput.addEventListener('input', debounce(searchEvents, 300));

            // ÌÖåÎßà ÌÜ†Í∏Ä
            elements.themeToggle.addEventListener('click', toggleTheme);

            // ÎÇ¥Î≥¥ÎÇ¥Í∏∞/Í∞ÄÏ†∏Ïò§Í∏∞
            elements.exportBtn.addEventListener('click', exportData);
            elements.importBtn.addEventListener('click', () => elements.importFile.click());
            elements.importFile.addEventListener('change', importData);

            // ÎØ∏Îãà Ï∫òÎ¶∞Îçî
            elements.miniPrevBtn.addEventListener('click', () => navigateMiniCalendar(-1));
            elements.miniNextBtn.addEventListener('click', () => navigateMiniCalendar(1));

            // Î™®Îã¨ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            elements.eventModal.addEventListener('click', (e) => {
                if (e.target === elements.eventModal) closeEventModal();
            });
            elements.categoryModal.addEventListener('click', (e) => {
                if (e.target === elements.categoryModal) closeCategoryModal();
            });

            // Ï¢ÖÏùº ÏùºÏ†ï Ï≤¥ÌÅ¨Î∞ïÏä§
            document.getElementById('allDayEvent').addEventListener('change', toggleAllDay);

            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
            document.addEventListener('keydown', handleKeyboardShortcuts);

            // ÌïÑÌÑ∞ Ïù¥Î≤§Ìä∏
            document.getElementById('allDayFilter').addEventListener('change', renderCalendar);
            document.getElementById('reminderFilter').addEventListener('change', renderCalendar);
        }

        function navigateCalendar(direction) {
            switch (currentView) {
                case 'month':
                    currentDate.setMonth(currentDate.getMonth() + direction);
                    break;
                case 'week':
                    currentDate.setDate(currentDate.getDate() + (direction * 7));
                    break;
                case 'day':
                    currentDate.setDate(currentDate.getDate() + direction);
                    break;
            }
            renderCalendar();
            renderMiniCalendar();
        }

        function navigateMiniCalendar(direction) {
            const miniDate = new Date(currentDate);
            miniDate.setMonth(miniDate.getMonth() + direction);
            currentDate = miniDate;
            renderCalendar();
            renderMiniCalendar();
        }

        function goToToday() {
            currentDate = new Date();
            renderCalendar();
            renderMiniCalendar();
        }

        function switchView(view) {
            currentView = view;
            
            // ÌôúÏÑ± Î≤ÑÌäº ÏóÖÎç∞Ïù¥Ìä∏
            elements.viewBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === view);
            });

            // Î∑∞ Ïª®ÌÖåÏù¥ÎÑà ÌëúÏãú/Ïà®ÍπÄ
            elements.monthView.classList.toggle('hidden', view !== 'month');
            elements.weekView.classList.toggle('hidden', view !== 'week');
            elements.dayView.classList.toggle('hidden', view !== 'day');

            renderCalendar();
        }

        function renderCalendar() {
            updateCurrentDateDisplay();
            
            switch (currentView) {
                case 'month':
                    renderMonthView();
                    break;
                case 'week':
                    renderWeekView();
                    break;
                case 'day':
                    renderDayView();
                    break;
            }
        }

        function updateCurrentDateDisplay() {
            const options = { year: 'numeric', month: 'long' };
            if (currentView === 'day') {
                options.day = 'numeric';
                options.weekday = 'long';
            } else if (currentView === 'week') {
                const weekStart = getWeekStart(currentDate);
                const weekEnd = getWeekEnd(currentDate);
                elements.currentDateEl.textContent = 
                    `${weekStart.getFullYear()}ÎÖÑ ${weekStart.getMonth() + 1}Ïõî ${weekStart.getDate()}Ïùº - ${weekEnd.getMonth() + 1}Ïõî ${weekEnd.getDate()}Ïùº`;
                return;
            }
            elements.currentDateEl.textContent = currentDate.toLocaleDateString('ko-KR', options);
        }

        function renderMonthView() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // ÏõîÏùò Ï≤´ ÎÇ†Í≥º ÎßàÏßÄÎßâ ÎÇ†
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            // Îã¨Î†• ÏãúÏûëÏùº (ÏõîÏöîÏùºÎ∂ÄÌÑ∞ ÏãúÏûë)
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - ((firstDay.getDay() + 6) % 7));
            
            elements.monthView.innerHTML = '';
            
            // ÏöîÏùº Ìó§Îçî
            const dayHeaders = ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'];
            dayHeaders.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = day;
                elements.monthView.appendChild(dayHeader);
            });
            
            // ÎÇ†Ïßú ÏÖÄ ÏÉùÏÑ±
            const today = new Date();
            for (let i = 0; i < 42; i++) {
                const cellDate = new Date(startDate);
                cellDate.setDate(startDate.getDate() + i);
                
                const dayCell = document.createElement('div');
                dayCell.className = 'day-cell';
                dayCell.dataset.date = cellDate.toISOString().split('T')[0];
                
                // ÌÅ¥ÎûòÏä§ Ï∂îÍ∞Ä
                if (cellDate.getMonth() !== month) {
                    dayCell.classList.add('other-month');
                }
                if (cellDate.toDateString() === today.toDateString()) {
                    dayCell.classList.add('today');
                }
                
                // ÎÇ†Ïßú Î≤àÌò∏
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = cellDate.getDate();
                dayCell.appendChild(dayNumber);
                
                // Ïù¥Î≤§Ìä∏ Î™©Î°ù
                const eventList = document.createElement('div');
                eventList.className = 'event-list';
                
                const dayEvents = getEventsForDate(cellDate);
                const filteredEvents = filterEvents(dayEvents);
                
                // Í∞Å ÏùºÏ†ïÏóê ÎåÄÌï¥ Ìï¥Îãπ ÎÇ†ÏßúÏóêÏÑú ÏãúÏûëÌïòÎäîÏßÄ ÌôïÏù∏
                const eventsToShow = filteredEvents.slice(0, 3).map(event => {
                    const eventStart = new Date(event.startDate);
                    const eventStartDate = eventStart.toISOString().split('T')[0];
                    const cellDateStr = cellDate.toISOString().split('T')[0];
                    
                    return {
                        ...event,
                        isStartDate: eventStartDate === cellDateStr,
                        isContinuation: eventStartDate !== cellDateStr
                    };
                });
                
                eventsToShow.forEach(eventInfo => {
                    const eventItem = document.createElement('div');
                    eventItem.className = 'event-item';
                    
                    // Ïó∞ÏÜç ÏùºÏ†ïÏù∏ Í≤ΩÏö∞ Ïä§ÌÉÄÏùº Î≥ÄÍ≤Ω
                    if (eventInfo.isContinuation) {
                        eventItem.style.backgroundColor = eventInfo.color;
                        eventItem.style.opacity = '0.7';
                        eventItem.style.borderLeft = `3px solid ${eventInfo.color}`;
                        eventItem.textContent = `‚ãØ ${eventInfo.title}`;
                        // Ïó∞ÏÜç ÏùºÏ†ïÏùÄ ÎìúÎûòÍ∑∏ Î∂àÍ∞Ä
                        eventItem.draggable = false;
                    } else {
                        eventItem.style.backgroundColor = eventInfo.color;
                        eventItem.textContent = eventInfo.title;
                        // ÏãúÏûë ÎÇ†ÏßúÏóêÏÑúÎßå ÎìúÎûòÍ∑∏ Í∞ÄÎä•
                        eventItem.draggable = true;
                        eventItem.addEventListener('dragstart', (e) => handleDragStart(e, eventInfo));
                    }
                    
                    eventItem.dataset.eventId = eventInfo.id;
                    eventItem.addEventListener('click', (e) => {
                        e.stopPropagation();
                        editEvent(eventInfo.id);
                    });
                    
                    eventList.appendChild(eventItem);
                });
                
                if (filteredEvents.length > 3) {
                    const moreItem = document.createElement('div');
                    moreItem.className = 'event-item';
                    moreItem.style.backgroundColor = '#999';
                    moreItem.textContent = `+${filteredEvents.length - 3}Í∞ú Îçî`;
                    eventList.appendChild(moreItem);
                }
                
                dayCell.appendChild(eventList);
                
                // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
                dayCell.addEventListener('click', () => openEventModal(cellDate));
                dayCell.addEventListener('dragover', handleDragOver);
                dayCell.addEventListener('drop', (e) => handleDrop(e, cellDate));
                
                elements.monthView.appendChild(dayCell);
            }
        }

        function renderWeekView() {
            // Ï£ºÍ∞Ñ Î∑∞ Íµ¨ÌòÑ
            const weekStart = getWeekStart(currentDate);
            elements.weekView.innerHTML = '';
            
            // ÏãúÍ∞Ñ Ïä¨Î°Ø Ìó§Îçî
            const timeHeader = document.createElement('div');
            timeHeader.className = 'time-slot';
            elements.weekView.appendChild(timeHeader);
            
            // ÏöîÏùº Ìó§Îçî
            for (let i = 0; i < 7; i++) {
                const date = new Date(weekStart);
                date.setDate(weekStart.getDate() + i);
                
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = `${date.getMonth() + 1}/${date.getDate()} (${['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'][date.getDay()]})`;
                elements.weekView.appendChild(dayHeader);
            }
            
            // ÏãúÍ∞ÑÎ≥Ñ Ìñâ ÏÉùÏÑ±
            for (let hour = 0; hour < 24; hour++) {
                const timeSlot = document.createElement('div');
                timeSlot.className = 'time-slot';
                timeSlot.textContent = `${hour.toString().padStart(2, '0')}:00`;
                elements.weekView.appendChild(timeSlot);
                
                for (let day = 0; day < 7; day++) {
                    const hourCell = document.createElement('div');
                    hourCell.className = 'hour-cell';
                    
                    const cellDate = new Date(weekStart);
                    cellDate.setDate(weekStart.getDate() + day);
                    cellDate.setHours(hour, 0, 0, 0);
                    
                    hourCell.dataset.date = cellDate.toISOString();
                    hourCell.addEventListener('click', () => openEventModal(cellDate));
                    
                    elements.weekView.appendChild(hourCell);
                }
            }
        }

        function renderDayView() {
            // ÏùºÍ∞Ñ Î∑∞ Íµ¨ÌòÑ
            elements.dayView.innerHTML = '';
            
            const dayStart = new Date(currentDate);
            dayStart.setHours(0, 0, 0, 0);
            
            // ÏãúÍ∞ÑÎ≥Ñ Ìñâ ÏÉùÏÑ± (ÏãúÍ∞Ñ ÎùºÎ≤®)
            for (let hour = 0; hour < 24; hour++) {
                const timeSlot = document.createElement('div');
                timeSlot.className = 'time-slot';
                timeSlot.textContent = `${hour.toString().padStart(2, '0')}:00`;
                elements.dayView.appendChild(timeSlot);
                
                const hourCell = document.createElement('div');
                hourCell.className = 'hour-cell';
                
                const cellDate = new Date(dayStart);
                cellDate.setHours(hour, 0, 0, 0);
                
                hourCell.dataset.date = cellDate.toISOString();
                hourCell.addEventListener('click', () => openEventModal(cellDate));
                
                elements.dayView.appendChild(hourCell);
            }
            
            // Ïù¥Î≤§Ìä∏ Ïª®ÌÖåÏù¥ÎÑà ÏÉùÏÑ±
            const eventContainer = document.createElement('div');
            eventContainer.className = 'day-view-container';
            eventContainer.style.position = 'absolute';
            eventContainer.style.top = '0';
            eventContainer.style.left = '61px'; // ÏãúÍ∞Ñ Ïä¨Î°Ø ÎÑàÎπÑÎßåÌÅº Ïù¥Îèô
            eventContainer.style.right = '0';
            eventContainer.style.height = `${24 * 60}px`; // 24ÏãúÍ∞Ñ * 60px per hour
            eventContainer.style.pointerEvents = 'none';
            
            // Îπà Í≥µÍ∞Ñ ÌÅ¥Î¶≠ÏúºÎ°ú Ïù¥Î≤§Ìä∏ ÏÉùÏÑ±
            eventContainer.addEventListener('click', (e) => {
                const rect = eventContainer.getBoundingClientRect();
                const y = e.clientY - rect.top;
                const minutes = Math.floor(y);
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                
                if (hours >= 0 && hours < 24) {
                    const clickDate = new Date(dayStart);
                    clickDate.setHours(hours, mins, 0, 0);
                    openEventModal(clickDate);
                }
            });
            eventContainer.style.pointerEvents = 'auto';
            
            // Î∂ÄÎ™® Ïª®ÌÖåÏù¥ÎÑàÏóê relative Ìè¨ÏßÄÏÖò ÏÑ§Ï†ï
            elements.dayView.style.position = 'relative';
            elements.dayView.appendChild(eventContainer);
            
            // ÌïòÎ£®Ïùò Î™®Îì† Ïù¥Î≤§Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞
            const dayEvents = getEventsForDay(dayStart);
            const filteredEvents = filterEvents(dayEvents);
            
            // Ïù¥Î≤§Ìä∏ Í≤πÏπ® Ï≤òÎ¶¨ Î∞è Î†åÎçîÎßÅ
            renderDayEvents(filteredEvents, eventContainer);
        }

        function renderMiniCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            elements.miniCalendarTitle.textContent = `${year}ÎÖÑ ${month + 1}Ïõî`;
            elements.miniCalendarGrid.innerHTML = '';
            
            // ÏöîÏùº Ìó§Îçî
            const dayHeaders = ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'];
            dayHeaders.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.className = 'mini-calendar-day';
                dayElement.style.fontWeight = 'bold';
                dayElement.style.color = 'var(--text-secondary)';
                dayElement.textContent = day;
                elements.miniCalendarGrid.appendChild(dayElement);
            });
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - ((firstDay.getDay() + 6) % 7));
            
            const today = new Date();
            
            for (let i = 0; i < 42; i++) {
                const cellDate = new Date(startDate);
                cellDate.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'mini-calendar-day';
                dayElement.textContent = cellDate.getDate();
                
                if (cellDate.getMonth() !== month) {
                    dayElement.classList.add('other-month');
                }
                if (cellDate.toDateString() === today.toDateString()) {
                    dayElement.classList.add('today');
                }
                
                dayElement.addEventListener('click', () => {
                    currentDate = new Date(cellDate);
                    renderCalendar();
                });
                
                elements.miniCalendarGrid.appendChild(dayElement);
            }
        }

        function getEventsForDate(date) {
            const dateStr = date.toISOString().split('T')[0];
            return events.filter(event => {
                const eventStart = new Date(event.startDate).toISOString().split('T')[0];
                const eventEnd = new Date(event.endDate).toISOString().split('T')[0];
                return dateStr >= eventStart && dateStr <= eventEnd;
            });
        }

        function getEventsForHour(date) {
            return events.filter(event => {
                const eventStart = new Date(event.startDate);
                const eventEnd = new Date(event.endDate);
                const hourStart = new Date(date);
                const hourEnd = new Date(date);
                hourEnd.setHours(hourEnd.getHours() + 1);
                
                return (eventStart < hourEnd && eventEnd > hourStart);
            });
        }

        function getEventsForDay(date) {
            const dayStart = new Date(date);
            dayStart.setHours(0, 0, 0, 0);
            const dayEnd = new Date(date);
            dayEnd.setHours(23, 59, 59, 999);
            
            return events.filter(event => {
                const eventStart = new Date(event.startDate);
                const eventEnd = new Date(event.endDate);
                
                return (eventStart < dayEnd && eventEnd > dayStart);
            });
        }

        function renderDayEvents(dayEvents, container) {
            if (dayEvents.length === 0) return;
            
            // Ïù¥Î≤§Ìä∏Î•º ÏãúÏûë ÏãúÍ∞ÑÏúºÎ°ú Ï†ïÎ†¨
            dayEvents.sort((a, b) => new Date(a.startDate) - new Date(b.startDate));
            
            // Í∞Å Ïù¥Î≤§Ìä∏Ïùò ÏúÑÏπò Ï†ïÎ≥¥ Í≥ÑÏÇ∞
            const eventPositions = calculateEventPositions(dayEvents);
            
            // Ïù¥Î≤§Ìä∏ Î†åÎçîÎßÅ
            eventPositions.forEach(eventInfo => {
                const eventElement = createDayEventElement(eventInfo);
                container.appendChild(eventElement);
            });
        }

        function calculateEventPositions(dayEvents) {
            const eventPositions = [];
            const columns = [];
            
            dayEvents.forEach(event => {
                const eventStart = new Date(event.startDate);
                const eventEnd = new Date(event.endDate);
                
                // ÏãúÍ∞ÑÏùÑ Î∂ÑÏúºÎ°ú Î≥ÄÌôò (ÌïòÎ£®Ïùò ÏãúÏûëÎ∂ÄÌÑ∞)
                const startMinutes = eventStart.getHours() * 60 + eventStart.getMinutes();
                const endMinutes = eventEnd.getHours() * 60 + eventEnd.getMinutes();
                const duration = endMinutes - startMinutes;
                
                // Í≤πÏπòÎäî Ïù¥Î≤§Ìä∏ Ï∞æÍ∏∞
                let columnIndex = 0;
                let overlappingEvents = [];
                
                // Í∏∞Ï°¥ Ïª¨ÎüºÎì§Í≥º Í≤πÏπòÎäîÏßÄ ÌôïÏù∏
                for (let i = 0; i < columns.length; i++) {
                    let hasOverlap = false;
                    for (let j = 0; j < columns[i].length; j++) {
                        const existingEvent = columns[i][j];
                        if (eventsOverlap(event, existingEvent.event)) {
                            hasOverlap = true;
                            overlappingEvents.push(existingEvent);
                            break;
                        }
                    }
                    if (!hasOverlap) {
                        columnIndex = i;
                        break;
                    }
                    if (i === columns.length - 1) {
                        columnIndex = columns.length;
                    }
                }
                
                // ÏÉà Ïª¨ÎüºÏù¥ ÌïÑÏöîÌïú Í≤ΩÏö∞
                if (columnIndex >= columns.length) {
                    columns.push([]);
                }
                
                const eventInfo = {
                    event: event,
                    startMinutes: startMinutes,
                    duration: duration,
                    columnIndex: columnIndex,
                    overlappingEvents: overlappingEvents
                };
                
                columns[columnIndex].push(eventInfo);
                eventPositions.push(eventInfo);
            });
            
            // Í∞Å Ïù¥Î≤§Ìä∏Ïùò ÎÑàÎπÑÏôÄ ÏúÑÏπò Í≥ÑÏÇ∞
            eventPositions.forEach(eventInfo => {
                const maxColumns = getMaxOverlappingColumns(eventInfo, eventPositions);
                eventInfo.width = 100 / maxColumns;
                eventInfo.left = eventInfo.columnIndex * eventInfo.width;
            });
            
            return eventPositions;
        }

        function eventsOverlap(event1, event2) {
            const start1 = new Date(event1.startDate);
            const end1 = new Date(event1.endDate);
            const start2 = new Date(event2.startDate);
            const end2 = new Date(event2.endDate);
            
            return start1 < end2 && start2 < end1;
        }

        function getMaxOverlappingColumns(eventInfo, allEvents) {
            let maxColumns = 1;
            
            allEvents.forEach(otherEvent => {
                if (eventInfo.event.id !== otherEvent.event.id && 
                    eventsOverlap(eventInfo.event, otherEvent.event)) {
                    maxColumns = Math.max(maxColumns, otherEvent.columnIndex + 1);
                }
            });
            
            return maxColumns;
        }

        function createDayEventElement(eventInfo) {
            const eventElement = document.createElement('div');
            eventElement.className = 'day-event-item';
            if (eventInfo.overlappingEvents.length > 0) {
                eventElement.classList.add('overlapping');
            }
            
            // Ïä§ÌÉÄÏùº ÏÑ§Ï†ï
            eventElement.style.backgroundColor = eventInfo.event.color;
            eventElement.style.top = `${eventInfo.startMinutes}px`;
            eventElement.style.height = `${Math.max(eventInfo.duration, 20)}px`; // ÏµúÏÜå ÎÜíÏù¥ 20px
            eventElement.style.left = `${eventInfo.left}%`;
            eventElement.style.width = `${eventInfo.width - 0.5}%`; // ÏïΩÍ∞ÑÏùò Í∞ÑÍ≤©
            eventElement.style.pointerEvents = 'auto';
            
            // Ïù¥Î≤§Ìä∏ Ï†ïÎ≥¥ ÌëúÏãú
            const timeText = formatEventTime(eventInfo.event);
            eventElement.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 2px;">${eventInfo.event.title}</div>
                <div style="font-size: 0.65rem; opacity: 0.9;">${timeText}</div>
            `;
            
            // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
            eventElement.dataset.eventId = eventInfo.event.id;
            eventElement.addEventListener('click', (e) => {
                e.stopPropagation();
                editEvent(eventInfo.event.id);
            });
            
            // ÎìúÎûòÍ∑∏ Í∏∞Îä•
            eventElement.draggable = true;
            eventElement.addEventListener('dragstart', (e) => handleDragStart(e, eventInfo.event));
            
            return eventElement;
        }

        function formatEventTime(event) {
            const start = new Date(event.startDate);
            const end = new Date(event.endDate);
            
            if (event.isAllDay) {
                return 'Ï¢ÖÏùº';
            }
            
            const startTime = `${start.getHours().toString().padStart(2, '0')}:${start.getMinutes().toString().padStart(2, '0')}`;
            const endTime = `${end.getHours().toString().padStart(2, '0')}:${end.getMinutes().toString().padStart(2, '0')}`;
            
            return `${startTime} - ${endTime}`;
        }

        function filterEvents(eventList) {
            const allDayFilter = document.getElementById('allDayFilter').checked;
            const reminderFilter = document.getElementById('reminderFilter').checked;
            const activeCategories = categories.filter(cat => cat.active).map(cat => cat.id);
            
            return eventList.filter(event => {
                // Ïπ¥ÌÖåÍ≥†Î¶¨ ÌïÑÌÑ∞
                if (!activeCategories.includes(event.category)) return false;
                
                // Ï¢ÖÏùº ÏùºÏ†ï ÌïÑÌÑ∞
                if (allDayFilter && !event.isAllDay) return false;
                
                // ÏïåÎ¶º ÌïÑÌÑ∞
                if (reminderFilter && (!event.reminder || event.reminder === 0)) return false;
                
                return true;
            });
        }

        function getWeekStart(date) {
            const start = new Date(date);
            const day = start.getDay();
            const diff = start.getDate() - day + (day === 0 ? -6 : 1);
            start.setDate(diff);
            start.setHours(0, 0, 0, 0);
            return start;
        }

        function getWeekEnd(date) {
            const end = getWeekStart(date);
            end.setDate(end.getDate() + 6);
            end.setHours(23, 59, 59, 999);
            return end;
        }

        function openEventModal(date = null, eventId = null) {
            editingEventId = eventId;
            
            if (eventId) {
                // Í∏∞Ï°¥ Ïù¥Î≤§Ìä∏ Ìé∏Ïßë
                const event = events.find(e => e.id === eventId);
                if (event) {
                    document.getElementById('modalTitle').textContent = 'ÏùºÏ†ï Ìé∏Ïßë';
                    document.getElementById('eventTitle').value = event.title;
                    document.getElementById('eventDescription').value = event.description || '';
                    document.getElementById('eventStartDate').value = formatDateTimeLocal(event.startDate);
                    document.getElementById('eventEndDate').value = formatDateTimeLocal(event.endDate);
                    document.getElementById('allDayEvent').checked = event.isAllDay || false;
                    document.getElementById('eventCategory').value = event.category;
                    document.getElementById('reminderTime').value = event.reminder || 0;
                    document.getElementById('repeatType').value = event.repeat || 'none';
                    
                    // ÏÉâÏÉÅ ÏÑ†ÌÉù
                    selectColor(event.color);
                    
                    elements.deleteEventBtn.style.display = 'block';
                }
            } else {
                // ÏÉà Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
                document.getElementById('modalTitle').textContent = 'ÏùºÏ†ï Ï∂îÍ∞Ä';
                elements.eventForm.reset();
                
                if (date) {
                    const startDate = new Date(date);
                    const endDate = new Date(date);
                    endDate.setHours(endDate.getHours() + 1);
                    
                    document.getElementById('eventStartDate').value = formatDateTimeLocal(startDate);
                    document.getElementById('eventEndDate').value = formatDateTimeLocal(endDate);
                }
                
                // Í∏∞Î≥∏ ÏÉâÏÉÅ ÏÑ†ÌÉù
                selectColor(colorPalette[0]);
                
                elements.deleteEventBtn.style.display = 'none';
            }
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨ ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            updateCategoryOptions();
            
            elements.eventModal.classList.add('show');
        }

        function closeEventModal() {
            elements.eventModal.classList.remove('show');
            editingEventId = null;
            elements.eventForm.reset();
        }

        function saveEvent(e) {
            e.preventDefault();
            
            const formData = new FormData(elements.eventForm);
            const eventData = {
                id: editingEventId || generateId(),
                title: document.getElementById('eventTitle').value,
                description: document.getElementById('eventDescription').value,
                startDate: document.getElementById('eventStartDate').value,
                endDate: document.getElementById('eventEndDate').value,
                isAllDay: document.getElementById('allDayEvent').checked,
                category: document.getElementById('eventCategory').value,
                color: getSelectedColor(),
                reminder: parseInt(document.getElementById('reminderTime').value),
                repeat: document.getElementById('repeatType').value
            };
            
            // Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            if (!eventData.title.trim()) {
                showNotification('Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            if (new Date(eventData.startDate) >= new Date(eventData.endDate)) {
                showNotification('Ï¢ÖÎ£å ÏãúÍ∞ÑÏùÄ ÏãúÏûë ÏãúÍ∞ÑÎ≥¥Îã§ Îä¶Ïñ¥Ïïº Ìï©ÎãàÎã§.', 'error');
                return;
            }
            
            if (editingEventId) {
                // Í∏∞Ï°¥ Ïù¥Î≤§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                const index = events.findIndex(e => e.id === editingEventId);
                if (index !== -1) {
                    events[index] = eventData;
                    showNotification('ÏùºÏ†ïÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.', 'success');
                }
            } else {
                // ÏÉà Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
                events.push(eventData);
                showNotification('ÏùºÏ†ïÏù¥ Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.', 'success');
            }
            
            // Î∞òÎ≥µ ÏùºÏ†ï Ï≤òÎ¶¨
            if (eventData.repeat !== 'none') {
                generateRecurringEvents(eventData);
            }
            
            saveEventsToStorage();
            renderCalendar();
            scheduleReminders();
            closeEventModal();
        }

        function deleteEvent() {
            if (editingEventId && confirm('Ï†ïÎßêÎ°ú Ïù¥ ÏùºÏ†ïÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                events = events.filter(e => e.id !== editingEventId);
                saveEventsToStorage();
                renderCalendar();
                closeEventModal();
                showNotification('ÏùºÏ†ïÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.', 'success');
            }
        }

        function editEvent(eventId) {
            openEventModal(null, eventId);
        }

        function generateRecurringEvents(baseEvent) {
            const startDate = new Date(baseEvent.startDate);
            const endDate = new Date(baseEvent.endDate);
            const duration = endDate.getTime() - startDate.getTime();
            
            const occurrences = 10; // ÏµúÎåÄ 10Ìöå Î∞òÎ≥µ
            
            for (let i = 1; i < occurrences; i++) {
                const newStartDate = new Date(startDate);
                
                switch (baseEvent.repeat) {
                    case 'daily':
                        newStartDate.setDate(startDate.getDate() + i);
                        break;
                    case 'weekly':
                        newStartDate.setDate(startDate.getDate() + (i * 7));
                        break;
                    case 'monthly':
                        newStartDate.setMonth(startDate.getMonth() + i);
                        break;
                    case 'yearly':
                        newStartDate.setFullYear(startDate.getFullYear() + i);
                        break;
                }
                
                const newEndDate = new Date(newStartDate.getTime() + duration);
                
                const recurringEvent = {
                    ...baseEvent,
                    id: generateId(),
                    startDate: newStartDate.toISOString(),
                    endDate: newEndDate.toISOString(),
                    isRecurring: true,
                    parentId: baseEvent.id
                };
                
                events.push(recurringEvent);
            }
        }

        function renderCategories() {
            elements.categoryList.innerHTML = '';
            
            categories.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = `category-item ${category.active ? 'active' : ''}`;
                categoryItem.innerHTML = `
                    <div class="category-color" style="background-color: ${category.color}"></div>
                    <span>${category.name}</span>
                `;
                
                categoryItem.addEventListener('click', () => {
                    category.active = !category.active;
                    categoryItem.classList.toggle('active', category.active);
                    saveCategoriestoStorage();
                    renderCalendar();
                });
                
                elements.categoryList.appendChild(categoryItem);
            });
        }

        function openCategoryModal() {
            elements.categoryModal.classList.add('show');
            initializeCategoryColorPicker();
        }

        function closeCategoryModal() {
            elements.categoryModal.classList.remove('show');
            elements.categoryForm.reset();
        }

        function saveCategory(e) {
            e.preventDefault();
            
            const name = document.getElementById('categoryName').value.trim();
            const color = getCategorySelectedColor();
            
            if (!name) {
                showNotification('Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.', 'error');
                return;
            }
            
            if (categories.some(cat => cat.name === name)) {
                showNotification('Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶ÑÏûÖÎãàÎã§.', 'error');
                return;
            }
            
            const newCategory = {
                id: generateId(),
                name: name,
                color: color,
                active: true
            };
            
            categories.push(newCategory);
            saveCategoriestoStorage();
            renderCategories();
            updateCategoryOptions();
            closeCategoryModal();
            showNotification('Ïπ¥ÌÖåÍ≥†Î¶¨Í∞Ä Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function initializeColorPickers() {
            const colorPicker = document.getElementById('colorPicker');
            const categoryColorPicker = document.getElementById('categoryColorPicker');
            
            colorPalette.forEach(color => {
                // Ïù¥Î≤§Ìä∏ ÏÉâÏÉÅ ÌîºÏª§
                const colorOption = document.createElement('div');
                colorOption.className = 'color-option';
                colorOption.style.backgroundColor = color;
                colorOption.dataset.color = color;
                colorOption.addEventListener('click', () => selectColor(color));
                colorPicker.appendChild(colorOption);
                
                // Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÉâÏÉÅ ÌîºÏª§
                const categoryColorOption = document.createElement('div');
                categoryColorOption.className = 'color-option';
                categoryColorOption.style.backgroundColor = color;
                categoryColorOption.dataset.color = color;
                categoryColorOption.addEventListener('click', () => selectCategoryColor(color));
                categoryColorPicker.appendChild(categoryColorOption);
            });
        }

        function initializeCategoryColorPicker() {
            const categoryColorPicker = document.getElementById('categoryColorPicker');
            selectCategoryColor(colorPalette[0]);
        }

        function selectColor(color) {
            document.querySelectorAll('#colorPicker .color-option').forEach(option => {
                option.classList.toggle('selected', option.dataset.color === color);
            });
        }

        function selectCategoryColor(color) {
            document.querySelectorAll('#categoryColorPicker .color-option').forEach(option => {
                option.classList.toggle('selected', option.dataset.color === color);
            });
        }

        function getSelectedColor() {
            const selected = document.querySelector('#colorPicker .color-option.selected');
            return selected ? selected.dataset.color : colorPalette[0];
        }

        function getCategorySelectedColor() {
            const selected = document.querySelector('#categoryColorPicker .color-option.selected');
            return selected ? selected.dataset.color : colorPalette[0];
        }

        function updateCategoryOptions() {
            const select = document.getElementById('eventCategory');
            select.innerHTML = '';
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = category.name;
                select.appendChild(option);
            });
        }

        function searchEvents() {
            const query = elements.searchInput.value.toLowerCase().trim();
            
            if (!query) {
                renderCalendar();
                return;
            }
            
            const filteredEvents = events.filter(event => {
                return event.title.toLowerCase().includes(query) ||
                       (event.description && event.description.toLowerCase().includes(query));
            });
            
            // Í≤ÄÏÉâ Í≤∞Í≥º ÌëúÏãú (Í∞ÑÎã®Ìïú Íµ¨ÌòÑ)
            console.log('Í≤ÄÏÉâ Í≤∞Í≥º:', filteredEvents);
            renderCalendar(); // Ïã§Ï†úÎ°úÎäî Í≤ÄÏÉâ Í≤∞Í≥ºÎßå ÌëúÏãúÌïòÎèÑÎ°ù ÏàòÏ†ï ÌïÑÏöî
        }

        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        showNotification('ÏïåÎ¶ºÏù¥ ÌóàÏö©ÎêòÏóàÏäµÎãàÎã§.', 'success');
                    }
                });
            }
        }

        function scheduleReminders() {
            // Í∏∞Ï°¥ ÏïåÎ¶º ÌÉÄÏù¥Î®∏ Ï†úÍ±∞
            reminderTimeouts.forEach(timeout => clearTimeout(timeout));
            reminderTimeouts = [];
            
            const now = new Date();
            
            events.forEach(event => {
                if (event.reminder && event.reminder > 0) {
                    const eventStart = new Date(event.startDate);
                    const reminderTime = new Date(eventStart.getTime() - (event.reminder * 60 * 1000));
                    
                    if (reminderTime > now) {
                        const timeout = setTimeout(() => {
                            showEventReminder(event);
                        }, reminderTime.getTime() - now.getTime());
                        
                        reminderTimeouts.push(timeout);
                    }
                }
            });
        }

        function showEventReminder(event) {
            const message = `${event.title} ÏùºÏ†ïÏù¥ ${event.reminder}Î∂Ñ ÌõÑÏóê ÏãúÏûëÎê©ÎãàÎã§.`;
            
            // Î∏åÎùºÏö∞Ï†Ä ÏïåÎ¶º
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('ÏùºÏ†ï ÏïåÎ¶º', {
                    body: message,
                    icon: 'üìÖ'
                });
            }
            
            // Ïù∏Ïï± ÏïåÎ¶º
            showNotification(message, 'warning');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-header">
                    <span class="notification-title">${type === 'success' ? 'ÏÑ±Í≥µ' : type === 'error' ? 'Ïò§Î•ò' : 'ÏïåÎ¶º'}</span>
                    <button class="close-btn" onclick="this.parentElement.parentElement.remove()">&times;</button>
                </div>
                <div class="notification-content">${message}</div>
            `;
            
            document.body.appendChild(notification);
            
            // 3Ï¥à ÌõÑ ÏûêÎèô Ï†úÍ±∞
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 3000);
        }

        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }

        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        }

        function toggleAllDay() {
            const isAllDay = document.getElementById('allDayEvent').checked;
            const startDateInput = document.getElementById('eventStartDate');
            const endDateInput = document.getElementById('eventEndDate');
            
            if (isAllDay) {
                // Ï¢ÖÏùº ÏùºÏ†ïÏúºÎ°ú Î≥ÄÍ≤Ω
                const startDate = new Date(startDateInput.value);
                const endDate = new Date(endDateInput.value);
                
                startDate.setHours(0, 0, 0, 0);
                endDate.setHours(23, 59, 59, 999);
                
                startDateInput.value = formatDateTimeLocal(startDate);
                endDateInput.value = formatDateTimeLocal(endDate);
            }
        }

        function handleKeyboardShortcuts(e) {
            // Ctrl/Cmd + N: ÏÉà ÏùºÏ†ï
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                openEventModal();
            }
            
            // Ctrl/Cmd + T: Ïò§ÎäòÎ°ú Ïù¥Îèô
            if ((e.ctrlKey || e.metaKey) && e.key === 't') {
                e.preventDefault();
                goToToday();
            }
            
            // Î∞©Ìñ•ÌÇ§: ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò
            if (e.key === 'ArrowLeft' && !e.target.matches('input, textarea')) {
                e.preventDefault();
                navigateCalendar(-1);
            }
            
            if (e.key === 'ArrowRight' && !e.target.matches('input, textarea')) {
                e.preventDefault();
                navigateCalendar(1);
            }
            
            // ESC: Î™®Îã¨ Îã´Í∏∞
            if (e.key === 'Escape') {
                if (elements.eventModal.classList.contains('show')) {
                    closeEventModal();
                }
                if (elements.categoryModal.classList.contains('show')) {
                    closeCategoryModal();
                }
            }
        }

        function handleDragStart(e, event) {
            // ÎìúÎûòÍ∑∏ Îç∞Ïù¥ÌÑ∞Ïóê Ïù¥Î≤§Ìä∏ Ï†ïÎ≥¥ Ï†ÄÏû•
            const dragData = {
                eventId: event.id,
                originalStartDate: event.startDate,
                originalEndDate: event.endDate
            };
            
            e.dataTransfer.setData('text/plain', JSON.stringify(dragData));
            e.target.classList.add('dragging');
            
            // Í∞ôÏùÄ Ïù¥Î≤§Ìä∏Ïùò Îã§Î•∏ Ïù∏Ïä§ÌÑ¥Ïä§Îì§ÎèÑ ÎìúÎûòÍ∑∏ ÏÉÅÌÉúÎ°ú ÌëúÏãú
            document.querySelectorAll(`[data-event-id="${event.id}"]`).forEach(el => {
                el.classList.add('dragging');
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drop-zone');
        }

        function handleDrop(e, targetDate) {
            e.preventDefault();
            e.currentTarget.classList.remove('drop-zone');
            
            try {
                // ÎìúÎûòÍ∑∏ Îç∞Ïù¥ÌÑ∞ ÌååÏã±
                const dragDataStr = e.dataTransfer.getData('text/plain');
                let dragData;
                
                // Ïù¥Ï†Ñ Î≤ÑÏ†Ñ Ìò∏ÌôòÏÑ± Ï≤¥ÌÅ¨
                try {
                    dragData = JSON.parse(dragDataStr);
                } catch {
                    // Ïù¥Ï†Ñ Î∞©Ïãù (Îã®Ïàú ID)Ïù∏ Í≤ΩÏö∞
                    dragData = { eventId: dragDataStr };
                }
                
                const eventId = dragData.eventId;
                const event = events.find(e => e.id === eventId);
                
                if (!event) {
                    console.warn('ÎìúÎûòÍ∑∏Îêú Ïù¥Î≤§Ìä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§:', eventId);
                    return;
                }
                
                // ÏõêÎ≥∏ ÏùºÏ†ï Ï†ïÎ≥¥
                const originalStart = new Date(event.startDate);
                const originalEnd = new Date(event.endDate);
                const duration = originalEnd.getTime() - originalStart.getTime();
                
                // ÏÉàÎ°úÏö¥ ÏãúÏûë ÎÇ†Ïßú ÏÑ§Ï†ï
                const newStart = new Date(targetDate);
                
                // Ï¢ÖÏùº ÏùºÏ†ïÏù∏ Í≤ΩÏö∞ Ï≤òÎ¶¨
                if (event.isAllDay) {
                    newStart.setHours(0, 0, 0, 0);
                    const newEnd = new Date(newStart.getTime() + duration);
                    
                    event.startDate = newStart.toISOString();
                    event.endDate = newEnd.toISOString();
                } else {
                    // ÏùºÎ∞ò ÏùºÏ†ïÏùò Í≤ΩÏö∞ ÏãúÍ∞Ñ Ïú†ÏßÄ
                    newStart.setHours(originalStart.getHours(), originalStart.getMinutes(), originalStart.getSeconds(), originalStart.getMilliseconds());
                    const newEnd = new Date(newStart.getTime() + duration);
                    
                    event.startDate = newStart.toISOString();
                    event.endDate = newEnd.toISOString();
                }
                
                // Îç∞Ïù¥ÌÑ∞ Ï†ïÌï©ÏÑ± Í≤ÄÏ¶ù Î∞è Ï†ÄÏû•
                validateAndSaveEvents();
                renderCalendar();
                showNotification('ÏùºÏ†ïÏù¥ Ïù¥ÎèôÎêòÏóàÏäµÎãàÎã§.', 'success');
                
            } catch (error) {
                console.error('ÏùºÏ†ï Ïù¥Îèô Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                showNotification('ÏùºÏ†ï Ïù¥Îèô Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.', 'error');
            }
            
            // ÎìúÎûòÍ∑∏ ÏÉÅÌÉú Ï†úÍ±∞
            document.querySelectorAll('.dragging').forEach(el => {
                el.classList.remove('dragging');
            });
        }

        function validateAndSaveEvents() {
            // Ï§ëÎ≥µ Ïù¥Î≤§Ìä∏ Ï†úÍ±∞ (Í∞ôÏùÄ IDÎ•º Í∞ÄÏßÑ Ïù¥Î≤§Ìä∏Í∞Ä Ïó¨Îü¨ Í∞ú ÏÉùÏÑ±ÎêòÎäî Í≤É Î∞©ÏßÄ)
            const uniqueEvents = [];
            const seenIds = new Set();
            
            events.forEach(evt => {
                if (evt && evt.id && !seenIds.has(evt.id)) {
                    // ÌïÑÏàò ÌïÑÎìú Í≤ÄÏ¶ù
                    if (evt.title && evt.startDate && evt.endDate) {
                        seenIds.add(evt.id);
                        uniqueEvents.push(evt);
                    } else {
                        console.warn('ÏûòÎ™ªÎêú Ïù¥Î≤§Ìä∏ Îç∞Ïù¥ÌÑ∞:', evt);
                    }
                }
            });
            
            events = uniqueEvents;
            saveEventsToStorage();
        }

        function exportData() {
            const data = {
                events: events,
                categories: categories,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `calendar_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Îç∞Ïù¥ÌÑ∞Í∞Ä ÎÇ¥Î≥¥ÎÇ¥Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
        }

        function importData(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.events && Array.isArray(data.events)) {
                        events = data.events;
                        saveEventsToStorage();
                    }
                    
                    if (data.categories && Array.isArray(data.categories)) {
                        categories = data.categories;
                        saveCategoriestoStorage();
                        renderCategories();
                        updateCategoryOptions();
                    }
                    
                    renderCalendar();
                    scheduleReminders();
                    showNotification('Îç∞Ïù¥ÌÑ∞Í∞Ä Í∞ÄÏ†∏Ïò§Í∏∞ÎêòÏóàÏäµÎãàÎã§.', 'success');
                    
                } catch (error) {
                    showNotification('ÌååÏùº ÌòïÏãùÏù¥ Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.', 'error');
                }
            };
            reader.readAsText(file);
            
            // ÌååÏùº ÏûÖÎ†• Ï¥àÍ∏∞Ìôî
            e.target.value = '';
        }

        // Ïú†Ìã∏Î¶¨Ìã∞ Ìï®ÏàòÎì§
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function formatDateTimeLocal(date) {
            const d = new Date(date);
            const year = d.getFullYear();
            const month = (d.getMonth() + 1).toString().padStart(2, '0');
            const day = d.getDate().toString().padStart(2, '0');
            const hours = d.getHours().toString().padStart(2, '0');
            const minutes = d.getMinutes().toString().padStart(2, '0');
            
            return `${year}-${month}-${day}T${hours}:${minutes}`;
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function saveEventsToStorage() {
            localStorage.setItem('calendarEvents', JSON.stringify(events));
        }

        function saveCategoriestoStorage() {
            localStorage.setItem('calendarCategories', JSON.stringify(categories));
        }

        // Ï†ëÍ∑ºÏÑ± Í∞úÏÑ†
        function setupAccessibility() {
            // ARIA ÎùºÎ≤® Ï∂îÍ∞Ä
            elements.monthView.setAttribute('role', 'grid');
            elements.monthView.setAttribute('aria-label', 'Îã¨Î†•');
            
            // ÌÇ§Î≥¥Îìú ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò ÏßÄÏõê
            document.addEventListener('keydown', (e) => {
                if (e.target.classList.contains('day-cell')) {
                    let targetCell = null;
                    
                    switch (e.key) {
                        case 'Enter':
                        case ' ':
                            e.preventDefault();
                            e.target.click();
                            break;
                        case 'ArrowLeft':
                            targetCell = e.target.previousElementSibling;
                            break;
                        case 'ArrowRight':
                            targetCell = e.target.nextElementSibling;
                            break;
                        case 'ArrowUp':
                            const upIndex = Array.from(e.target.parentElement.children).indexOf(e.target) - 7;
                            targetCell = e.target.parentElement.children[upIndex];
                            break;
                        case 'ArrowDown':
                            const downIndex = Array.from(e.target.parentElement.children).indexOf(e.target) + 7;
                            targetCell = e.target.parentElement.children[downIndex];
                            break;
                    }
                    
                    if (targetCell && targetCell.classList.contains('day-cell')) {
                        e.preventDefault();
                        targetCell.focus();
                    }
                }
            });
        }

        // ÏÑ±Îä• ÏµúÏ†ÅÌôî
        function optimizePerformance() {
            // Í∞ÄÏÉÅ Ïä§ÌÅ¨Î°§ÎßÅ (ÎåÄÎüâ Îç∞Ïù¥ÌÑ∞Ïö©)
            // Î©îÎ™®Î¶¨ ÎàÑÏàò Î∞©ÏßÄ
            window.addEventListener('beforeunload', () => {
                reminderTimeouts.forEach(timeout => clearTimeout(timeout));
            });
        }

        // Ïï± Ï¥àÍ∏∞Ìôî ÌõÑ Ï†ëÍ∑ºÏÑ± Î∞è ÏÑ±Îä• ÏÑ§Ï†ï
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                setupAccessibility();
                optimizePerformance();
            }, 100);
        });
    </script>
</body>
</html>
