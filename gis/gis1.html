<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ë“±í¬êµ¬ì²­ ì§€ë„1111111</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .search-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .search-container input {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
        }

        .search-container button {
            padding: 10px 25px;
            background: white;
            color: #667eea;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }

        .search-container button:hover {
            transform: scale(1.05);
        }

        .controls {
            background: #f8f9fa;
            padding: 15px 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .btn {
            padding: 8px 16px;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #667eea;
            color: white;
        }

        .btn.active {
            background: #667eea;
            color: white;
        }

        #map {
            flex: 1;
            width: 100%;
        }

        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            max-width: 300px;
            z-index: 1000;
            display: none;
        }

        .info-panel.show {
            display: block;
        }

        .info-panel h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 18px;
        }

        .info-panel p {
            margin: 5px 0;
            font-size: 14px;
            color: #333;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }

        .leaflet-popup-content-wrapper {
            border-radius: 10px;
        }

        .leaflet-popup-content {
            margin: 15px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ—ºï¸ ì˜ë“±í¬êµ¬ì²­ ì§€ë„</h1>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="ì¥ì†Œ ê²€ìƒ‰... (ì˜ˆ: ì¹´í˜, ë³‘ì›, ì€í–‰)">
            <button onclick="searchPlace()">ê²€ìƒ‰</button>
        </div>
    </div>

    <div class="controls">
        <button class="btn active" onclick="setMapType('street')">ê±°ë¦¬ë·°</button>
        <button class="btn" onclick="setMapType('satellite')">ìœ„ì„±</button>
        <button class="btn" onclick="findMyLocation()">ğŸ“ ë‚´ ìœ„ì¹˜</button>
        <button class="btn" onclick="resetView()">ğŸ¢ êµ¬ì²­ ìœ„ì¹˜</button>
    </div>

    <div id="map"></div>

    <div class="info-panel" id="infoPanel">
        <button class="close-btn" onclick="closeInfo()">Ã—</button>
        <h3 id="infoTitle">ì˜ë“±í¬êµ¬ì²­</h3>
        <p id="infoContent">ì„œìš¸íŠ¹ë³„ì‹œ ì˜ë“±í¬êµ¬ì˜ í–‰ì • ì¤‘ì‹¬ì§€ì…ë‹ˆë‹¤.</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
        // ì˜ë“±í¬êµ¬ì²­ ì¢Œí‘œ
        const yeongdeungpoOffice = [37.5264, 126.8958];
        let map, currentMarker, currentLayer;

        // ì§€ë„ ì´ˆê¸°í™”
        function initMap() {
            map = L.map('map').setView(yeongdeungpoOffice, 15);

            // ê¸°ë³¸ ë ˆì´ì–´ (OpenStreetMap)
            currentLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);

            // ì˜ë“±í¬êµ¬ì²­ ë§ˆì»¤ ì¶”ê°€
            const officeMarker = L.marker(yeongdeungpoOffice, {
                title: 'ì˜ë“±í¬êµ¬ì²­'
            }).addTo(map);

            officeMarker.bindPopup(`
                <div style="text-align: center;">
                    <h3 style="color: #667eea; margin-bottom: 8px;">ğŸ¢ ì˜ë“±í¬êµ¬ì²­</h3>
                    <p style="margin: 5px 0;">ì„œìš¸íŠ¹ë³„ì‹œ ì˜ë“±í¬êµ¬</p>
                    <p style="margin: 5px 0;">ì¤‘ì•™ë¡œ 176</p>
                </div>
            `);

            // í´ë¦­ ì´ë²¤íŠ¸ë¡œ ë§ˆì»¤ ì¶”ê°€
            map.on('click', onMapClick);
        }

        // ì§€ë„ í´ë¦­ ì´ë²¤íŠ¸
        function onMapClick(e) {
            if (currentMarker) {
                map.removeLayer(currentMarker);
            }

            currentMarker = L.marker(e.latlng).addTo(map);
            currentMarker.bindPopup(`
                <div>
                    <strong>ì„ íƒí•œ ìœ„ì¹˜</strong><br>
                    ìœ„ë„: ${e.latlng.lat.toFixed(5)}<br>
                    ê²½ë„: ${e.latlng.lng.toFixed(5)}
                </div>
            `).openPopup();
        }

        // ì§€ë„ íƒ€ì… ë³€ê²½
        function setMapType(type) {
            // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
            document.querySelectorAll('.controls .btn').forEach(btn => {
                if (btn.textContent.includes('ê±°ë¦¬ë·°') || btn.textContent.includes('ìœ„ì„±')) {
                    btn.classList.remove('active');
                }
            });
            event.target.classList.add('active');

            // í˜„ì¬ ë ˆì´ì–´ ì œê±°
            if (currentLayer) {
                map.removeLayer(currentLayer);
            }

            // ìƒˆ ë ˆì´ì–´ ì¶”ê°€
            if (type === 'street') {
                currentLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Â© OpenStreetMap contributors',
                    maxZoom: 19
                }).addTo(map);
            } else if (type === 'satellite') {
                currentLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                    attribution: 'Tiles Â© Esri',
                    maxZoom: 19
                }).addTo(map);
            }
        }

        // ë‚´ ìœ„ì¹˜ ì°¾ê¸°
        function findMyLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const pos = [position.coords.latitude, position.coords.longitude];
                    map.setView(pos, 16);

                    if (currentMarker) {
                        map.removeLayer(currentMarker);
                    }

                    currentMarker = L.marker(pos).addTo(map);
                    currentMarker.bindPopup('ğŸ“ ë‚´ í˜„ì¬ ìœ„ì¹˜').openPopup();
                }, () => {
                    alert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                });
            } else {
                alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
            }
        }

        // êµ¬ì²­ ìœ„ì¹˜ë¡œ ë¦¬ì…‹
        function resetView() {
            map.setView(yeongdeungpoOffice, 15);
        }

        // ì¥ì†Œ ê²€ìƒ‰ (Nominatim API ì‚¬ìš©)
        async function searchPlace() {
            const query = document.getElementById('searchInput').value;
            if (!query) {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            // ì˜ë“±í¬êµ¬ ì£¼ë³€ìœ¼ë¡œ ê²€ìƒ‰ ì œí•œ
            const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query + ' ì˜ë“±í¬êµ¬ ì„œìš¸')}&limit=5`;

            try {
                const response = await fetch(url);
                const results = await response.json();

                if (results.length > 0) {
                    const result = results[0];
                    const pos = [parseFloat(result.lat), parseFloat(result.lon)];
                    
                    map.setView(pos, 17);

                    if (currentMarker) {
                        map.removeLayer(currentMarker);
                    }

                    currentMarker = L.marker(pos).addTo(map);
                    currentMarker.bindPopup(`
                        <div>
                            <strong>${result.display_name}</strong>
                        </div>
                    `).openPopup();
                } else {
                    alert('ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                alert('ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì •ë³´ íŒ¨ë„ ë‹«ê¸°
        function closeInfo() {
            document.getElementById('infoPanel').classList.remove('show');
        }

        // Enter í‚¤ë¡œ ê²€ìƒ‰
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchPlace();
            }
        });

        // ì§€ë„ ì´ˆê¸°í™” ì‹¤í–‰
        initMap();
    </script>
</body>
</html>